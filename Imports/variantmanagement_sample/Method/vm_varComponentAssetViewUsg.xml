<AML>
 <Item type="Method" id="E6C21732C5C348A78FAFD973916DBC05" action="add">
  <execution_allowed_to keyed_name="Administrators" type="Identity">2618D6F5A90949BAA7E920D1B04C7EE1</execution_allowed_to>
  <method_code><![CDATA[require(
	['Modules/aras.innovator.VariantManagementSample/Scripts/componentAssetUsageConditionItemsLoader'],
	function(UsageConditionItemsLoader) {
		const aras = window.aras;
		const createTitle = function(relationshipItemId) {
			const vmModuleSolutionBasedRelativePath = '../Modules/aras.innovator.VariantManagementSample';

			const assetRelatedIdNode = window.item.selectSingleNode('Relationships/Item[@id="' + relationshipItemId + '"]/related_id');
			const assetKeyedName = assetRelatedIdNode.getAttribute('keyed_name');
			return aras.getResource(vmModuleSolutionBasedRelativePath, 'usage_condition_item_grid_view.title') +
				(assetKeyedName ? aras.getResource(vmModuleSolutionBasedRelativePath, 'usage_condition_item_grid_view.title_divider') + assetKeyedName : '');
		};

		const usageConditionItemsLoader = new UsageConditionItemsLoader(aras);

		const relationshipItemId = inArgs.componentAssetRelationshipItemId;
		const title = createTitle(relationshipItemId);

		const getComponentDefaultVariabilityItem = function() {
			// Check window.item if it already contains loaded default VariabilityItem
			const defaultVariabilityItemNode = window.item.selectSingleNode('./Relationships/Item[@type="vm_VarComponentVariabilityItem"]/related_id/Item');

			let defaultVariabilityItem;

			if (defaultVariabilityItemNode) {
				defaultVariabilityItem = aras.newIOMItem();
				defaultVariabilityItem.dom = defaultVariabilityItemNode.ownerDocument;
				defaultVariabilityItem.node = defaultVariabilityItemNode;

				return defaultVariabilityItem;
			}

			// Load default VariabilityItem from server
			defaultVariabilityItem = aras.newIOMItem('vm_VariabilityItem', 'get');
			defaultVariabilityItem.setAttribute('select', 'id,keyed_name');

			const componentItemId = aras.getItemProperty(window.item, 'id');
			const relationshipItem = aras.newIOMItem('vm_VarComponentVariabilityItem');
			relationshipItem.setProperty('source_id', componentItemId);

			defaultVariabilityItem.setPropertyItem('id', relationshipItem);
			defaultVariabilityItem.setPropertyCondition('id', 'in');
			defaultVariabilityItem.setPropertyAttribute('id', 'by', 'related_id');

			defaultVariabilityItem = defaultVariabilityItem.apply();

			if (defaultVariabilityItem.isError()) {
				if (defaultVariabilityItem.getErrorCode() !== '0') {
					aras.AlertError(defaultVariabilityItem);
				}

				return null;
			}

			return defaultVariabilityItem;
		};

		aras.evalMethod('vm_showRelsRightSplitterPaneView', '', {
			aras: aras,
			viewPath: aras.getBaseURL() + '/Modules/aras.innovator.VariantManagementSample/Views/usageConditionItemGrid.html',
			title: title,
			usageConditionItemsLoader: usageConditionItemsLoader,
			usageConditionSourceItemId: relationshipItemId,
			getDefaultVariabilityItem: getComponentDefaultVariabilityItem
		});
	}
);]]></method_code>
  <method_type>JavaScript</method_type>
  <name>vm_varComponentAssetViewUsg</name>
 </Item>
</AML>